# 第18章 安全架构设计理论与实践

- **18.1 安全架构概述**
    - **安全威胁**: 物理环境, 通信链路, 网络系统, 操作系统, 应用系统, 管理系统
        - **常见威胁**: 信息泄露, 破坏完整性, 拒绝服务 (DoS), 非授权访问, 窃听, 业务流分析, 假冒, 旁路控制, 授权侵犯, 特洛伊木马, 陷阱门, 抵赖, 重放, 病毒
    - **安全架构定义**: 
        - **三道防线**: 产品安全架构, 安全技术体系架构, 审计架构
        - **特性**: 可用性 (Availability), 完整性 (Integrity), 机密性 (Confidentiality)
    - **标准与组织**:
        - **国际**: TCSEC (橘皮书), ITSEC, CC (Common Criteria, ISO 15408), ISO 7498-2 (OSI安全架构), IEC 61508
        - **国内**: GB/T 17859 (等级保护), GB/T 18336 (安全评估), GJB (军标)
- **18.2 安全模型**
    - **状态机模型**: 系统在任何时刻都处于安全状态，利用状态变量和转换规则描述
    - **Bell-LaPadula (BLP) 模型**:
        - **关注点**: 机密性 (Confidentiality) - 多级安全
        - **规则**:
            - **Simple Security (No Read Up)**: 低级别不可读高级别
            - **Star Property (No Write Down)**: 高级别不可写低级别
    - **Biba 模型**:
        - **关注点**: 完整性 (Integrity)
        - **规则**:
            - **Simple Integrity (No Read Down)**: 高级别不可读低级别 (防止污染)
            - **Star Integrity (No Write Up)**: 低级别不可写高级别 (防止篡改)
    - **Clark-Wilson (CWM) 模型**:
        - **关注点**: 完整性 (商业事务处理)
        - **核心概念**: 职责分离 (Separation of Duty), 完整性验证过程 (IVP), 转换过程 (TP)
    - **Chinese Wall 模型**:
        - **关注点**: 利益冲突 (Conflict of Interest) - 多边安全
        - **规则**: 混合策略 (MAC + DAC), 访问过某公司数据后，不可访问其竞争对手数据
- **18.3 系统安全体系架构规划框架**
    - **技术体系**: 物理安全, 系统安全 (应用/主机/存储/网络)
    - **组织体系**: 机构 (决策/管理/执行), 岗位, 人事
    - **管理体系**: 法律, 制度, 培训
    - **规划框架**: 依托企业信息化战略, 围绕技术/管理/组织, 核心是保护信息资源
- **18.4 信息安全整体架构设计 (WPDRRC模型)**
    - **模型演进**: PDR -> PDRR (Protect, Detect, React, Restore) -> WPDRRC
    - **6个环节**:
        - **预警 (Warning)**: 收集风险，模拟攻击，分析趋势 (新增)
        - **保护 (Protect)**: 加密, 签名, 访问控制, 防火墙
        - **检测 (Detect)**: IDS, 漏洞扫描, 完整性检测
        - **响应 (Respond)**: 应急策略, 阻断, 隔离, 报警
        - **恢复 (Restore)**: 容错, 冗余, 备份, 修复
        - **反击 (Counterattack)**: 侦察, 取证, 打击 (新增)
    - **3大要素**: 人员 (核心), 策略 (桥梁), 技术 (保证)
- **18.5 网络安全体系架构设计**
    - **OSI安全架构**:
        - **5类安全服务**: 鉴别, 访问控制, 数据机密性, 数据完整性, 抗抵赖性
        - **8类安全机制**: 加密, 数字签名, 访问控制, 数据完整性, 鉴别交换, 业务流填充, 路由控制, 公证
        - **分层配置**: 物理层, 网络层, 运输层, 应用层 (会话层不宜配置)
    - **认证框架 (Authentication)**:
        - **方式**: 已知 (口令), 拥有 (卡/令牌), 特性 (生物特征), 第三方, 环境
    - **访问控制框架**:
        - **组件**: 发起者, 目标, AEF (实施), ADF (判决), ACI (控制信息)
    - **机密性框架**: 禁止访问, 加密 (对称/非对称), 业务流填充
    - **完整性框架**: 阻止修改, 检测修改 (签名/指纹/序列号)
    - **抗抵赖框架**: 证据生成, 传输存储, 验证, 解决纠纷 (仲裁)
- **18.6 数据库系统的安全设计**
    - **评估标准**: TCSEC/TDI (B1级以上为安全产品)
    - **完整性设计**:
        - **原则**: 实体完整性, 引用完整性, 慎用触发器, 命名规范
        - **类型**: 列级/元组级/关系级 (静态/动态)
        - **实现**: 需求分析 -> 概念设计(ERD) -> 逻辑设计(Schema约束)
- **18.7 系统架构的脆弱性分析**
    - **软件脆弱性**:
        - **生命周期**: 引入 -> 破坏 -> 修补 -> 消失
        - **来源**: 设计瑕疵, 实现弱点, 配置错误
    - **典型架构脆弱性**:
        - **分层架构**: 层间错误传播, 通信效率低
        - **C/S架构**: 客户端易被分析, 协议脆弱, 数据分布风险
        - **B/S架构**: HTTP协议弱点, 易受病毒/脚本攻击
        - **事件驱动架构**: 组件控制力弱, 数据交换复杂, 死循环风险, 高并发难控
        - **MVC架构**: 复杂性, 视图/控制器紧耦合, 低效访问
        - **微内核**: 整体优化难, 进程间通信开销大
        - **微服务**: 分布式复杂性, 消息传递延迟, 服务管理复杂
- **18.8 安全架构设计案例分析**
    - **电子商务 (RADIUS)**:
        - **AAA**: 认证 (Authentication), 授权 (Authorization), 审计 (Accounting)
        - **架构**: 协议逻辑层 (转发), 业务逻辑层 (核心处理), 数据逻辑层 (DB代理)
        - **高性能**: 负载均衡, 进程/线程模型, 缓存
    - **混合云工业安全**:
        - **架构**: 设备层, 控制层 (SCADA/DCS), 设计管理层 (MES/ERP), 应用层
        - **5大安全重点**:
            - **设备安全**: 维护检测
            - **网络安全**: 防火墙, IDS, 杀毒
            - **控制安全**: 冗余容错, 备份
            - **应用安全**: 身份认证, 访问控制
            - **数据安全**: 加密, 备份, 异地容灾
